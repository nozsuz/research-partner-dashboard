<!DOCTYPE html>
<html>
<head>
    <title>ãƒ†ã‚¹ãƒˆç”¨ãƒœã‚¿ãƒ³</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        .btn-primary {
            background-color: #007bff;
            color: white;
        }
        .btn-primary:hover {
            background-color: #0056b3;
        }
        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }
        .btn-secondary:hover {
            background-color: #545b62;
        }
        .btn-danger {
            background-color: #dc3545;
            color: white;
        }
        .btn-danger:hover {
            background-color: #c82333;
        }
        .output {
            background: white;
            padding: 15px;
            border-radius: 5px;
            border: 1px solid #ddd;
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª ãƒã‚¤ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</h1>
    
    <div class="test-buttons">
        <button class="btn btn-primary" onclick="createTestProject()">
            âœ… ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
        </button>
        <button class="btn btn-secondary" onclick="debugLocalStorage()">
            ğŸ” ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ç¢ºèª
        </button>
        <button class="btn btn-secondary" onclick="openMainPage()">
            ğŸ  ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸è¡¨ç¤º
        </button>
        <button class="btn btn-danger" onclick="clearAllProjects()">
            ğŸ—‘ï¸ å…¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå‰Šé™¤
        </button>
    </div>

    <div id="output" class="output">
        æº–å‚™å®Œäº† - ä¸Šã®ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ†ã‚¹ãƒˆã‚’é–‹å§‹ã—ã¦ãã ã•ã„ã€‚
    </div>

    <script>
        // ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
        function createTestProject() {
            const tempProjects = JSON.parse(localStorage.getItem('tempProjects') || '[]');
            const testProject = {
                id: 'test-' + Date.now(),
                name: 'ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ ' + (tempProjects.length + 1),
                description: 'ã“ã‚Œã¯ãƒ†ã‚¹ãƒˆç”¨ã®ä»®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚ãƒã‚¤ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ©Ÿèƒ½ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ä½œæˆã•ã‚Œã¾ã—ãŸã€‚',
                status: 'created',
                created_at: new Date().toISOString(),
                selected_researchers: [
                    { name: 'ãƒ†ã‚¹ãƒˆç ”ç©¶è€…A', university: 'ãƒ†ã‚¹ãƒˆå¤§å­¦', researchmap_url: 'https://researchmap.jp/test-a' },
                    { name: 'ãƒ†ã‚¹ãƒˆç ”ç©¶è€…B', university: 'ã‚µãƒ³ãƒ—ãƒ«å¤§å­¦', researchmap_url: 'https://researchmap.jp/test-b' }
                ]
            };
            
            tempProjects.push(testProject);
            localStorage.setItem('tempProjects', JSON.stringify(tempProjects));
            
            updateOutput(`
                âœ… ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸï¼
                
                ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå: ${testProject.name}
                ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆID: ${testProject.id}
                ç ”ç©¶è€…æ•°: ${testProject.selected_researchers.length}å
                
                ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¿ãƒ–ã§ç¢ºèªã—ã¦ãã ã•ã„ã€‚
            `);
        }

        // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®çŠ¶æ…‹ã‚’ç¢ºèª
        function debugLocalStorage() {
            const tempProjects = JSON.parse(localStorage.getItem('tempProjects') || '[]');
            
            let output = `
                ğŸ“‹ ç¾åœ¨ã®ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®çŠ¶æ…‹:
                
                - ä»®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ•°: ${tempProjects.length}ä»¶
                
            `;
            
            if (tempProjects.length > 0) {
                output += 'ğŸ“‚ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§:\n';
                tempProjects.forEach((project, index) => {
                    output += `  ${index + 1}. ${project.name} (${project.status})\n`;
                    output += `     ID: ${project.id}\n`;
                    output += `     ç ”ç©¶è€…: ${project.selected_researchers.length}å\n`;
                    output += `     ä½œæˆæ—¥: ${new Date(project.created_at).toLocaleString('ja-JP')}\n\n`;
                });
            } else {
                output += 'ğŸ“‚ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã‚ã‚Šã¾ã›ã‚“ã€‚\n';
            }
            
            // ä»–ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸æƒ…å ±ã‚‚è¡¨ç¤º
            const savedAnalyses = JSON.parse(localStorage.getItem('savedAnalyses') || '[]');
            output += `\nğŸ“Š ãã®ä»–ã®ãƒ‡ãƒ¼ã‚¿:\n`;
            output += `- ä¿å­˜æ¸ˆã¿åˆ†æ: ${savedAnalyses.length}ä»¶\n`;
            
            updateOutput(output);
        }

        // ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã‚’é–‹ã
        function openMainPage() {
            window.location.href = 'index.html';
        }

        // å…¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’å‰Šé™¤
        function clearAllProjects() {
            if (confirm('å…¨ã¦ã®ä»®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚')) {
                localStorage.removeItem('tempProjects');
                updateOutput('ğŸ—‘ï¸ å…¨ã¦ã®ä»®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚');
            }
        }

        // å‡ºåŠ›ã‚¨ãƒªã‚¢ã‚’æ›´æ–°
        function updateOutput(message) {
            const output = document.getElementById('output');
            output.innerHTML = `
                <div style="white-space: pre-line; font-family: monospace; background: #f8f9fa; padding: 10px; border-radius: 4px;">
                    ${message}
                </div>
                <div style="margin-top: 10px; font-size: 12px; color: #666;">
                    ${new Date().toLocaleString('ja-JP')} ã«å®Ÿè¡Œ
                </div>
            `;
        }

        // åˆæœŸåŒ–æ™‚ã«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸çŠ¶æ…‹ã‚’è¡¨ç¤º
        window.onload = function() {
            debugLocalStorage();
        };
    </script>
</body>
</html>
