<!DOCTYPE html>\n<html lang=\"ja\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>プロジェクト作成テスト</title>\n    <style>\n        body {\n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n            padding: 20px;\n            max-width: 800px;\n            margin: 0 auto;\n        }\n        .test-section {\n            background: #f8f9fa;\n            padding: 20px;\n            border-radius: 8px;\n            margin: 20px 0;\n        }\n        .btn {\n            padding: 10px 20px;\n            margin: 5px;\n            border: none;\n            border-radius: 4px;\n            cursor: pointer;\n            background: #667eea;\n            color: white;\n        }\n        .log {\n            background: #e9ecef;\n            padding: 10px;\n            border-radius: 4px;\n            font-family: monospace;\n            white-space: pre-wrap;\n            max-height: 300px;\n            overflow-y: auto;\n            margin-top: 10px;\n        }\n    </style>\n</head>\n<body>\n    <h1>🧪 プロジェクト作成機能テスト</h1>\n    \n    <div class=\"test-section\">\n        <h3>1. ローカルストレージ状況確認</h3>\n        <button class=\"btn\" onclick=\"checkLocalStorage()\">ローカルストレージをチェック</button>\n        <div id=\"storage-log\" class=\"log\"></div>\n    </div>\n    \n    <div class=\"test-section\">\n        <h3>2. プロジェクトマネージャー状態確認</h3>\n        <button class=\"btn\" onclick=\"checkProjectManager()\">プロジェクトマネージャーをチェック</button>\n        <div id=\"manager-log\" class=\"log\"></div>\n    </div>\n    \n    <div class=\"test-section\">\n        <h3>3. 簡単なプロジェクト作成テスト</h3>\n        <button class=\"btn\" onclick=\"testCreateProject()\">テストプロジェクトを作成</button>\n        <div id=\"create-log\" class=\"log\"></div>\n    </div>\n    \n    <div class=\"test-section\">\n        <h3>4. 保存されたプロジェクト一覧</h3>\n        <button class=\"btn\" onclick=\"listProjects()\">プロジェクト一覧を表示</button>\n        <button class=\"btn\" onclick=\"clearProjects()\" style=\"background: #dc3545;\">全プロジェクトを削除</button>\n        <div id=\"list-log\" class=\"log\"></div>\n    </div>\n    \n    <script src=\"config.js\"></script>\n    <script src=\"api-client.js\"></script>\n    <script src=\"js/project-manager.js\"></script>\n    <script>\n        function log(elementId, message) {\n            const element = document.getElementById(elementId);\n            const timestamp = new Date().toLocaleTimeString();\n            element.textContent += `[${timestamp}] ${message}\\n`;\n            element.scrollTop = element.scrollHeight;\n        }\n        \n        function checkLocalStorage() {\n            const logId = 'storage-log';\n            document.getElementById(logId).textContent = '';\n            \n            try {\n                // ローカルストレージの基本テスト\n                localStorage.setItem('test-key', 'test-value');\n                const testValue = localStorage.getItem('test-key');\n                log(logId, `✅ ローカルストレージ基本動作: ${testValue}`);\n                localStorage.removeItem('test-key');\n                \n                // 既存のプロジェクトをチェック\n                const tempProjects = JSON.parse(localStorage.getItem('tempProjects') || '[]');\n                log(logId, `📁 既存プロジェクト数: ${tempProjects.length}`);\n                \n                tempProjects.forEach((project, index) => {\n                    log(logId, `  ${index + 1}. ${project.name} (ID: ${project.id})`);\n                });\n                \n                // ブラウザの制限をチェック\n                const quota = navigator.storage ? 'Available' : 'Not Available';\n                log(logId, `💾 Storage API: ${quota}`);\n                \n            } catch (error) {\n                log(logId, `❌ エラー: ${error.message}`);\n            }\n        }\n        \n        function checkProjectManager() {\n            const logId = 'manager-log';\n            document.getElementById(logId).textContent = '';\n            \n            log(logId, `🔍 window.ProjectManager存在: ${typeof window.ProjectManager !== 'undefined'}`);\n            log(logId, `🔍 window.projectManager存在: ${typeof window.projectManager !== 'undefined'}`);\n            \n            if (window.projectManager) {\n                log(logId, `🔍 useAPI設定: ${window.projectManager.useAPI}`);\n                log(logId, `🔍 createTempProject関数: ${typeof window.projectManager.createTempProject}`);\n                log(logId, `🔍 getTempProjectsLocal関数: ${typeof window.projectManager.getTempProjectsLocal}`);\n                \n                // 簡単な機能テスト\n                try {\n                    const projects = window.projectManager.getTempProjectsLocal();\n                    log(logId, `✅ getTempProjectsLocal動作確認: ${projects.length}件`);\n                } catch (error) {\n                    log(logId, `❌ getTempProjectsLocalエラー: ${error.message}`);\n                }\n            }\n        }\n        \n        async function testCreateProject() {\n            const logId = 'create-log';\n            document.getElementById(logId).textContent = '';\n            \n            if (!window.projectManager) {\n                log(logId, '❌ プロジェクトマネージャーが存在しません');\n                return;\n            }\n            \n            const testData = {\n                name: `テストプロジェクト ${new Date().getTime()}`,\n                description: 'これはテスト用のプロジェクトです',\n                budget: '1000',\n                duration: '12',\n                requirements: 'テスト要件',\n                keywords: 'テスト, AI, 機械学習'\n            };\n            \n            log(logId, '🚀 テストプロジェクト作成開始...');\n            log(logId, `📋 テストデータ: ${JSON.stringify(testData, null, 2)}`);\n            \n            try {\n                const result = await window.projectManager.createTempProject(testData);\n                log(logId, `✅ プロジェクト作成成功!`);\n                log(logId, `📁 作成されたプロジェクト: ${JSON.stringify(result, null, 2)}`);\n                \n                // 保存確認\n                const saved = JSON.parse(localStorage.getItem('tempProjects') || '[]');\n                log(logId, `💾 保存確認: 総プロジェクト数 ${saved.length}`);\n                \n            } catch (error) {\n                log(logId, `❌ プロジェクト作成失敗: ${error.message}`);\n                log(logId, `📋 エラースタック: ${error.stack}`);\n            }\n        }\n        \n        function listProjects() {\n            const logId = 'list-log';\n            document.getElementById(logId).textContent = '';\n            \n            try {\n                const tempProjects = JSON.parse(localStorage.getItem('tempProjects') || '[]');\n                log(logId, `📂 保存されているプロジェクト: ${tempProjects.length}件`);\n                \n                if (tempProjects.length === 0) {\n                    log(logId, '📂 プロジェクトがありません');\n                } else {\n                    tempProjects.forEach((project, index) => {\n                        log(logId, `\\n${index + 1}. ${project.name}`);\n                        log(logId, `   ID: ${project.id}`);\n                        log(logId, `   作成日: ${project.created_at}`);\n                        log(logId, `   ステータス: ${project.status}`);\n                        log(logId, `   研究者数: ${(project.selected_researchers || []).length}`);\n                    });\n                }\n            } catch (error) {\n                log(logId, `❌ エラー: ${error.message}`);\n            }\n        }\n        \n        function clearProjects() {\n            if (confirm('全てのプロジェクトを削除しますか？')) {\n                localStorage.removeItem('tempProjects');\n                const logId = 'list-log';\n                document.getElementById(logId).textContent = '';\n                log(logId, '🗑️ 全プロジェクトを削除しました');\n            }\n        }\n        \n        // ページ読み込み時にプロジェクトマネージャーが初期化されるまで待機\n        document.addEventListener('DOMContentLoaded', function() {\n            setTimeout(() => {\n                if (window.projectManager) {\n                    console.log('✅ プロジェクトマネージャー初期化完了');\n                } else {\n                    console.warn('⚠️ プロジェクトマネージャー初期化失敗');\n                }\n            }, 1000);\n        });\n    </script>\n</body>\n</html>\n